{"ast":null,"code":"var _jsxFileName = \"D:\\\\PAF_SL\\\\skillSharingAndLearningPlatform\\\\frontend\\\\src\\\\components\\\\comments\\\\CommentItem.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport moment from 'moment';\nimport { FaReply, FaEdit, FaTrash } from 'react-icons/fa';\nimport CommentForm from './CommentForm';\nimport commentService from '../../services/commentService';\nimport './CommentItem.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CommentItem = ({\n  comment,\n  postId,\n  onCommentUpdated\n}) => {\n  _s();\n  const [showReplyForm, setShowReplyForm] = useState(false);\n  const [showEditForm, setShowEditForm] = useState(false);\n  const [isDeleting, setIsDeleting] = useState(false);\n\n  // Assuming we have the current user's ID from a context or prop\n  const currentUserId = localStorage.getItem('userId');\n  const isCommentOwner = currentUserId === comment.userId;\n  const handleReply = () => {\n    setShowReplyForm(!showReplyForm);\n    setShowEditForm(false);\n  };\n  const handleEdit = () => {\n    setShowEditForm(!showEditForm);\n    setShowReplyForm(false);\n  };\n  const handleDelete = async () => {\n    if (window.confirm('Are you sure you want to delete this comment?')) {\n      setIsDeleting(true);\n      try {\n        await commentService.deleteComment(comment.id);\n        onCommentUpdated();\n      } catch (error) {\n        console.error('Error deleting comment:', error);\n        alert('Failed to delete comment. Please try again.');\n      } finally {\n        setIsDeleting(false);\n      }\n    }\n  };\n  const handleCommentAdded = () => {\n    setShowReplyForm(false);\n    onCommentUpdated();\n  };\n  const handleCommentUpdated = () => {\n    setShowEditForm(false);\n    onCommentUpdated();\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"comment-item\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"comment-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"comment-user-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"comment-username\",\n          children: comment.username || 'Anonymous'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"comment-time\",\n          children: moment(comment.createdAt).fromNow()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"comment-actions\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"action-button\",\n          onClick: handleReply,\n          children: [/*#__PURE__*/_jsxDEV(FaReply, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 61,\n            columnNumber: 13\n          }, this), \" Reply\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 11\n        }, this), isCommentOwner && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"action-button\",\n            onClick: handleEdit,\n            children: [/*#__PURE__*/_jsxDEV(FaEdit, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 66,\n              columnNumber: 17\n            }, this), \" Edit\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"action-button delete\",\n            onClick: handleDelete,\n            disabled: isDeleting,\n            children: [/*#__PURE__*/_jsxDEV(FaTrash, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 73,\n              columnNumber: 17\n            }, this), \" Delete\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this), !showEditForm ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"comment-content\",\n      children: comment.content\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(CommentForm, {\n      postId: postId,\n      commentId: comment.id,\n      initialValue: comment.content,\n      onCommentAdded: handleCommentUpdated,\n      isEdit: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }, this), showReplyForm && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"reply-form-container\",\n      children: /*#__PURE__*/_jsxDEV(CommentForm, {\n        postId: postId,\n        parentId: comment.id,\n        onCommentAdded: handleCommentAdded,\n        isReply: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }, this), comment.replies && comment.replies.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"comment-replies\",\n      children: comment.replies.map(reply => /*#__PURE__*/_jsxDEV(CommentItem, {\n        comment: reply,\n        postId: postId,\n        onCommentUpdated: onCommentUpdated\n      }, reply.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, this);\n};\n_s(CommentItem, \"LUlY8gGxUfpMixqLPi4D6KF8wQY=\");\n_c = CommentItem;\nexport default CommentItem;\nvar _c;\n$RefreshReg$(_c, \"CommentItem\");","map":{"version":3,"names":["React","useState","moment","FaReply","FaEdit","FaTrash","CommentForm","commentService","jsxDEV","_jsxDEV","Fragment","_Fragment","CommentItem","comment","postId","onCommentUpdated","_s","showReplyForm","setShowReplyForm","showEditForm","setShowEditForm","isDeleting","setIsDeleting","currentUserId","localStorage","getItem","isCommentOwner","userId","handleReply","handleEdit","handleDelete","window","confirm","deleteComment","id","error","console","alert","handleCommentAdded","handleCommentUpdated","className","children","username","fileName","_jsxFileName","lineNumber","columnNumber","createdAt","fromNow","onClick","disabled","content","commentId","initialValue","onCommentAdded","isEdit","parentId","isReply","replies","length","map","reply","_c","$RefreshReg$"],"sources":["D:/PAF_SL/skillSharingAndLearningPlatform/frontend/src/components/comments/CommentItem.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport moment from 'moment';\r\nimport { FaReply, FaEdit, FaTrash } from 'react-icons/fa';\r\nimport CommentForm from './CommentForm';\r\nimport commentService from '../../services/commentService';\r\nimport './CommentItem.css';\r\n\r\nconst CommentItem = ({ comment, postId, onCommentUpdated }) => {\r\n  const [showReplyForm, setShowReplyForm] = useState(false);\r\n  const [showEditForm, setShowEditForm] = useState(false);\r\n  const [isDeleting, setIsDeleting] = useState(false);\r\n  \r\n  // Assuming we have the current user's ID from a context or prop\r\n  const currentUserId = localStorage.getItem('userId');\r\n  const isCommentOwner = currentUserId === comment.userId;\r\n\r\n  const handleReply = () => {\r\n    setShowReplyForm(!showReplyForm);\r\n    setShowEditForm(false);\r\n  };\r\n\r\n  const handleEdit = () => {\r\n    setShowEditForm(!showEditForm);\r\n    setShowReplyForm(false);\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    if (window.confirm('Are you sure you want to delete this comment?')) {\r\n      setIsDeleting(true);\r\n      try {\r\n        await commentService.deleteComment(comment.id);\r\n        onCommentUpdated();\r\n      } catch (error) {\r\n        console.error('Error deleting comment:', error);\r\n        alert('Failed to delete comment. Please try again.');\r\n      } finally {\r\n        setIsDeleting(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleCommentAdded = () => {\r\n    setShowReplyForm(false);\r\n    onCommentUpdated();\r\n  };\r\n\r\n  const handleCommentUpdated = () => {\r\n    setShowEditForm(false);\r\n    onCommentUpdated();\r\n  };\r\n\r\n  return (\r\n    <div className=\"comment-item\">\r\n      <div className=\"comment-header\">\r\n        <div className=\"comment-user-info\">\r\n          <span className=\"comment-username\">{comment.username || 'Anonymous'}</span>\r\n          <span className=\"comment-time\">{moment(comment.createdAt).fromNow()}</span>\r\n        </div>\r\n        <div className=\"comment-actions\">\r\n          <button className=\"action-button\" onClick={handleReply}>\r\n            <FaReply /> Reply\r\n          </button>\r\n          {isCommentOwner && (\r\n            <>\r\n              <button className=\"action-button\" onClick={handleEdit}>\r\n                <FaEdit /> Edit\r\n              </button>\r\n              <button \r\n                className=\"action-button delete\" \r\n                onClick={handleDelete}\r\n                disabled={isDeleting}\r\n              >\r\n                <FaTrash /> Delete\r\n              </button>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n      \r\n      {!showEditForm ? (\r\n        <div className=\"comment-content\">{comment.content}</div>\r\n      ) : (\r\n        <CommentForm \r\n          postId={postId} \r\n          commentId={comment.id} \r\n          initialValue={comment.content}\r\n          onCommentAdded={handleCommentUpdated}\r\n          isEdit={true}\r\n        />\r\n      )}\r\n      \r\n      {showReplyForm && (\r\n        <div className=\"reply-form-container\">\r\n          <CommentForm \r\n            postId={postId} \r\n            parentId={comment.id}\r\n            onCommentAdded={handleCommentAdded}\r\n            isReply={true}\r\n          />\r\n        </div>\r\n      )}\r\n      \r\n      {comment.replies && comment.replies.length > 0 && (\r\n        <div className=\"comment-replies\">\r\n          {comment.replies.map(reply => (\r\n            <CommentItem \r\n              key={reply.id} \r\n              comment={reply} \r\n              postId={postId}\r\n              onCommentUpdated={onCommentUpdated}\r\n            />\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CommentItem;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}